"use strict";(self.webpackChunkyang_template=self.webpackChunkyang_template||[]).push([[701],{701:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var o=n(571),r=n(469),s=n(7671),c=n(3140);const i=function(e){return(0,c.jsx)("div",{onMouseDown:t=>{e.onMouseDown&&e.onMouseDown(t)},children:e.children?e.children:""})},a="rectPanelItem--wXqQU",l="circlePanelItem--h380o";var d=n(4447);class h extends r.NB{}!function(e){function t(e){const t=[],n=r.Lu.getForeignObjectMarkup();return e?t.push({tagName:e,selector:"body"},n):t.push(n),t}e.config({view:"react-shape-view",markup:t(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks(e){if(null==e.markup){const n=e.primer;if(n){e.markup=t(n);let o={};switch(n){case"circle":o={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":o={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}e.attrs=r.QK.merge({},{body:Object.assign({refWidth:null,refHeight:null},o)},e.attrs||{})}}return e}}),r.NB.registry.register("react-shape",e,!0)}(h||(h={}));var u,p=n(5654),f=n(2196);!function(e){let t,n=!1;const r=(e,t)=>{const n=t.payload;switch(t.type){case"add":{const t=e.findIndex((e=>e.id===n.id));return t>=0?(e[t]=n,[...e]):[...e,n]}case"remove":{const t=e.findIndex((e=>e.id===n.id));if(t>=0){const n=[...e];return n.splice(t,1),n}break}}return e};e.connect=function(e,o){n&&t({type:"add",payload:{id:e,portal:o}})},e.disconnect=function(e){n&&t({type:"remove",payload:{id:e}})},e.isActive=function(){return n},e.getProvider=function(){return()=>{n=!0;const[e,s]=(0,o.useReducer)(r,[]);return t=s,o.createElement(o.Fragment,{children:e.map((e=>e.portal))})}}}(u||(u={}));var m=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};const g={};function y(e){const{shape:t,component:n,effect:o,inherit:s}=e,c=m(e,["shape","component","effect","inherit"]);if(!t)throw new Error("should specify shape in config");g[t]={component:n,effect:o},r.kJ.registerNode(t,Object.assign({inherit:s||"react-shape"},c),!0)}class b extends o.PureComponent{constructor(e){super(e),this.state={tick:0}}componentDidMount(){const{node:e}=this.props;e.on("change:*",(t=>{let{key:n}=t;const o=g[e.shape];if(o){const{effect:e}=o;e&&!e.includes(n)||this.setState({tick:this.state.tick+1})}}))}clone(e){const{node:t,graph:n}=this.props;return"string"===typeof e.type?o.cloneElement(e):o.cloneElement(e,{node:t,graph:n})}render(){const{node:e}=this.props,t=g[e.shape];if(!t)return null;const{component:n}=t;if(o.isValidElement(n))return this.clone(n);const r=n;return this.clone(o.createElement(r,null))}}class v extends r.DK{targetId(){return"".concat(this.graph.view.cid,":").concat(this.cell.id)}getComponentContainer(){return this.selectors&&this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,v.action,(()=>{this.renderReactComponent()}))}renderReactComponent(){this.unmountReactComponent();const e=this.getComponentContainer(),t=this.cell;if(e){const n=o.createElement(b,{node:t,graph:this.graph});if(u.isActive()){const o=(0,p.createPortal)(n,e,t.id);u.connect(this.targetId(),o)}else this.root=(0,f.createRoot)(e),this.root.render(n)}}unmountReactComponent(){this.getComponentContainer()&&this.root&&(this.root.unmount(),this.root=void 0)}onMouseDown(e,t,n){const o=e.target;if("input"===o.tagName.toLowerCase()){const e=o.getAttribute("type");if(null==e||["text","password","number","email","search","tel","url"].includes(e))return}super.onMouseDown(e,t,n)}unmount(){return u.isActive()&&u.disconnect(this.targetId()),this.unmountReactComponent(),super.unmount(),this}}!function(e){e.action="react",e.config({bootstrap:[e.action],actions:{component:e.action}}),r.DK.registry.register("react-shape-view",e,!0)}(v||(v={}));var x=n(3444);const w="customReactNode--IfAU_",k="customCircleNode--bUBNP";y({shape:"custom-react-node",component:e=>{let{node:t}=e;const n=t.prop("label");return(0,c.jsx)(x.Z,{menu:{items:[{key:"delete",label:"\u5220\u9664"}]},trigger:["contextMenu"],children:(0,c.jsx)("div",{className:w,children:n})})}}),y({shape:"custom-circle-node",component:e=>{let{node:t}=e;const n=t.prop("label");return(0,c.jsx)(x.Z,{menu:{items:[{key:"delete",label:"\u5220\u9664"}]},trigger:["contextMenu"],children:(0,c.jsx)("div",{className:k,children:n})})}});const j={rect:{shape:"custom-react-node",width:100,height:40,label:"\u77e9\u5f62",attrs:{body:{stroke:"#8f8f8f",strokeWidth:1}}},circle:{shape:"custom-circle-node",width:40,height:40,label:"\u5706\u5f62",attrs:{body:{stroke:"#8f8f8f",strokeWidth:1}}}},C={nodes:[{id:"node1",shape:"custom-react-node",x:240,y:240,width:100,height:40,label:"hello",attrs:{body:{stroke:"#8f8f8f",strokeWidth:1,fill:"#fff",rx:6,ry:6}}},{id:"node2",shape:"custom-react-node",x:360,y:380,width:100,height:40,label:"world",attrs:{body:{stroke:"#8f8f8f",strokeWidth:1,fill:"#fff",rx:6,ry:6}}}],edges:[{shape:"edge",source:"node1",target:"node2",label:"x6",attrs:{line:{stroke:"#8f8f8f",strokeWidth:1}}}]};let N,O;const M=()=>{(0,o.useEffect)((()=>{const e=document.getElementById("container");e&&(N=new r.kJ({container:e,autoResize:!0,background:{color:"#F2F7FA"},grid:{visible:!0,type:"doubleMesh",args:[{color:"#eee",thickness:1},{color:"#ddd",thickness:1,factor:4}]},panning:!0,mousewheel:!0}),N.use(new s.H({enabled:!0})),N.fromJSON(C),O=new d.q({target:N}),setTimeout((()=>{var e;null===(e=N)||void 0===e||e.centerContent()}),100))}),[]);const e=(e,t)=>{if(N){var n;const o=N.createNode(j[t]);null===(n=O)||void 0===n||n.start(o,e.nativeEvent)}};return(0,c.jsxs)("div",{style:{width:"100%",height:"100%"},className:"grid grid-rows-[6rem_1fr_12rem] grid-cols-1  gap-3",children:[(0,c.jsxs)("div",{style:{boxShadow:"0 0 10px #ccc"},className:"bg-white relative z-10 p-2",children:[(0,c.jsx)("div",{className:"h-8 flex items-center",children:"\u6d41\u7a0b\u8282\u70b9"}),(0,c.jsxs)("div",{className:"h-12 flex gap-2",children:[(0,c.jsx)(i,{onMouseDown:t=>{e(t,"rect")},children:(0,c.jsx)("div",{className:a,children:"\u77e9\u5f62"})}),(0,c.jsx)(i,{onMouseDown:t=>{e(t,"circle")},children:(0,c.jsx)("div",{className:l,children:"\u5706\u5f62"})})]})]}),(0,c.jsx)("div",{style:{height:"100%",overflow:"hidden",boxShadow:"0 0 10px #ccc"},children:(0,c.jsx)("div",{className:"w-full h-full relative",children:(0,c.jsx)("div",{id:"container"})})}),(0,c.jsx)("div",{style:{boxShadow:"0 0 10px #ccc"},className:"bg-white relative z-10",children:"22222222222"})]})}}}]);